# 欢乐麻将辅助工具 - 项目需求文档

## 1. 项目概述

### 1.1 项目背景
麻将作为一种深受欢迎的智力游戏，需要玩家具备较强的牌面分析能力和概率计算能力。本项目旨在开发一个智能的麻将游戏辅助工具，帮助玩家提升游戏体验和决策水平。

### 1.2 项目目标
- 提供智能的麻将牌面分析和建议
- 实时计算胡牌概率和剩余牌信息
- 提供直观友好的用户界面
- 支持多平台访问（桌面端、移动端）

### 1.3 目标用户
- 麻将爱好者和学习者
- 希望提升麻将技能的玩家
- 麻将培训机构和教练

## 2. 功能需求

### 2.1 核心功能需求

#### FR-01 手牌管理
- **功能描述**: 用户可以输入和管理自己的手牌
- **具体需求**:
  - 支持添加/删除手牌
  - 支持选择多张牌进行批量操作
  - 手牌数量限制为13-14张
  - 实时显示手牌张数

#### FR-02 麻将桌弃牌管理
- **功能描述**: 以四家围坐的形式展示各玩家的弃牌
- **具体需求**:
  - 四家围坐的麻将桌布局（我、下家、对家、上家）
  - 每家独立的弃牌区域
  - 弃牌按时间顺序排列
  - 支持选择弃牌对应的玩家
  - 弃牌数量统计显示

#### FR-03 智能弃牌建议
- **功能描述**: 基于当前牌面状态提供最优弃牌建议
- **具体需求**:
  - 分析每张牌的弃牌价值
  - 计算弃牌后的听牌概率
  - 提供多个弃牌选项排序
  - 显示建议理由和分析

#### FR-04 剩余牌计算
- **功能描述**: 实时计算和显示场上剩余的各种牌
- **具体需求**:
  - 按牌型分类显示剩余数量
  - 考虑已知手牌和弃牌
  - 实时更新剩余牌信息
  - 支持按需牌类型筛选显示

#### FR-05 胡牌概率分析
- **功能描述**: 计算当前状态下的胡牌概率
- **具体需求**:
  - 基于剩余牌计算概率
  - 考虑不同听牌类型
  - 提供概率数值和图表展示
  - 支持历史概率变化追踪

#### FR-06 听牌检测
- **功能描述**: 自动检测当前是否听牌及听牌类型
- **具体需求**:
  - 实时检测听牌状态
  - 显示听牌类型（单吊、边张、坎张等）
  - 显示所有听牌选择
  - 计算各听牌的胡牌概率

### 2.2 界面功能需求

#### FR-07 麻将牌可视化
- **功能描述**: 提供直观的麻将牌视觉界面
- **具体需求**:
  - 高保真的麻将牌设计
  - 支持不同尺寸（大、中、小、微小）
  - 牌面文字清晰可读
  - 支持选中、推荐、禁用等状态

#### FR-08 输入模式切换
- **功能描述**: 支持不同的牌面输入模式
- **具体需求**:
  - 添加到手牌模式
  - 直接弃牌模式
  - 模式间的快速切换
  - 当前模式状态显示

#### FR-09 弃牌玩家选择
- **功能描述**: 在弃牌模式下可选择弃牌的玩家
- **具体需求**:
  - 四个玩家选项（我、下家、对家、上家）
  - 不同玩家用不同颜色标识
  - 当前选中玩家的视觉反馈
  - 快速切换功能

## 3. 非功能需求

### 3.1 性能需求
- **NFR-01**: 页面加载时间 < 3秒
- **NFR-02**: 牌面分析响应时间 < 1秒
- **NFR-03**: 支持并发用户数 > 100
- **NFR-04**: 内存使用优化，避免内存泄漏

### 3.2 可用性需求
- **NFR-05**: 界面响应式设计，支持桌面和移动设备
- **NFR-06**: 操作简单直观，新用户学习成本 < 10分钟
- **NFR-07**: 支持键盘快捷键操作
- **NFR-08**: 错误提示友好明确

### 3.3 兼容性需求
- **NFR-09**: 支持主流浏览器（Chrome, Firefox, Safari, Edge）
- **NFR-10**: 兼容移动端浏览器
- **NFR-11**: 支持不同屏幕分辨率

### 3.4 安全性需求
- **NFR-12**: 用户数据本地存储，不上传服务器
- **NFR-13**: API接口安全防护
- **NFR-14**: 防止恶意请求和攻击

## 4. 用户故事

### 4.1 新手用户
```
作为一个麻将新手
我希望能够得到智能的弃牌建议
以便我能够学习正确的麻将策略
```

### 4.2 进阶玩家
```
作为一个有经验的麻将玩家
我希望能够查看详细的概率分析
以便我能够验证和优化我的决策
```

### 4.3 学习者
```
作为一个麻将学习者
我希望能够记录完整的牌局过程
以便我能够复盘和分析牌局
```

### 4.4 移动用户
```
作为一个手机用户
我希望能够在手机上流畅使用工具
以便我能够随时随地进行麻将分析
```

## 5. 约束条件

### 5.1 技术约束
- 前端必须使用React技术栈
- 后端必须使用Python FastAPI
- 必须支持实时通信
- 必须支持离线使用基本功能

### 5.2 业务约束
- 工具仅供学习和娱乐使用
- 不得用于实际赌博活动
- 保护用户隐私和数据安全

### 5.3 时间约束
- 项目开发周期为8周
- 每个迭代周期为2周
- 必须按时交付可用版本

## 6. 验收标准

### 6.1 功能验收
- 所有核心功能按需求实现
- 界面操作流畅无卡顿
- 分析结果准确可靠
- 多平台兼容性测试通过

### 6.2 性能验收
- 性能指标达到要求
- 压力测试通过
- 内存和CPU使用合理

### 6.3 用户体验验收
- 用户体验测试评分 > 4.0/5.0
- 新用户上手时间 < 10分钟
- 界面设计美观现代

## 7. 风险分析

### 7.1 技术风险
- **算法复杂性**: 麻将概率计算算法复杂，可能影响性能
- **状态管理**: 复杂的游戏状态管理可能导致bug
- **跨平台兼容**: 不同设备和浏览器的兼容性问题

### 7.2 项目风险
- **需求变更**: 可能出现需求变更影响进度
- **技术挑战**: 新技术学习成本可能超出预期
- **测试覆盖**: 测试用例覆盖不够可能导致质量问题

### 7.3 缓解措施
- 提前进行技术预研和原型验证
- 建立完善的测试体系
- 定期进行代码审查和重构
- 保持与用户的及时沟通反馈 