{"ast":null,"code":"export let TileType = /*#__PURE__*/function (TileType) {\n  TileType[\"WAN\"] = \"wan\";\n  // 万\n  TileType[\"TIAO\"] = \"tiao\";\n  // 条\n  TileType[\"TONG\"] = \"tong\";\n  // 筒\n  TileType[\"ZI\"] = \"zi\"; // 字牌\n  return TileType;\n}({});\nexport let MeldType = /*#__PURE__*/function (MeldType) {\n  MeldType[\"PENG\"] = \"peng\";\n  // 碰\n  MeldType[\"GANG\"] = \"gang\";\n  // 杠\n  MeldType[\"CHI\"] = \"chi\"; // 吃\n  return MeldType;\n}({});\nexport let GangType = /*#__PURE__*/function (GangType) {\n  GangType[\"MING_GANG\"] = \"ming_gang\";\n  // 明杠（直杠）\n  GangType[\"AN_GANG\"] = \"an_gang\";\n  // 暗杠\n  GangType[\"JIA_GANG\"] = \"jia_gang\"; // 加杠\n  return GangType;\n}({});\n// 输入模式枚举\nexport let InputMode = /*#__PURE__*/function (InputMode) {\n  InputMode[\"ADD_TO_HAND\"] = \"add_to_hand\";\n  InputMode[\"DISCARD\"] = \"discard\";\n  InputMode[\"PENG\"] = \"peng\";\n  InputMode[\"MING_GANG\"] = \"ming_gang\";\n  InputMode[\"AN_GANG\"] = \"an_gang\";\n  return InputMode;\n}({});\n\n// 工具函数\nexport const createTile = (type, value) => ({\n  type,\n  value\n});\nexport const tileToCode = tile => {\n  switch (tile.type) {\n    case TileType.WAN:\n      return tile.value;\n    case TileType.TIAO:\n      return tile.value + 10;\n    case TileType.TONG:\n      return tile.value + 20;\n    case TileType.ZI:\n      return tile.value + 30;\n    default:\n      throw new Error(`Invalid tile type: ${tile.type}`);\n  }\n};\nexport const codeToTile = code => {\n  if (1 <= code && code <= 9) {\n    return {\n      type: TileType.WAN,\n      value: code\n    };\n  } else if (11 <= code && code <= 19) {\n    return {\n      type: TileType.TIAO,\n      value: code - 10\n    };\n  } else if (21 <= code && code <= 29) {\n    return {\n      type: TileType.TONG,\n      value: code - 20\n    };\n  } else if (31 <= code && code <= 37) {\n    return {\n      type: TileType.ZI,\n      value: code - 30\n    };\n  } else {\n    throw new Error(`Invalid tile code: ${code}`);\n  }\n};\nexport const tileToString = tile => {\n  const typeMap = {\n    [TileType.WAN]: \"万\",\n    [TileType.TIAO]: \"条\",\n    [TileType.TONG]: \"筒\",\n    [TileType.ZI]: [\"\", \"东\", \"南\", \"西\", \"北\", \"中\", \"发\", \"白\"][tile.value] || \"\"\n  };\n  if (tile.type === TileType.ZI) {\n    return typeMap[tile.type];\n  } else {\n    return `${tile.value}${typeMap[tile.type]}`;\n  }\n};\nexport const tilesEqual = (tile1, tile2) => {\n  return tile1.type === tile2.type && tile1.value === tile2.value;\n};\n\n// 计算剩余牌数\nexport const calculateRemainingTiles = gameState => {\n  const totalTiles = 144; // 标准麻将总牌数\n\n  // 计算已使用的牌数\n  let usedTiles = 0;\n\n  // 计算所有玩家手牌数量\n  Object.values(gameState.player_hands).forEach(hand => {\n    usedTiles += hand.tiles.length;\n    // 计算碰牌杠牌数量\n    hand.melds.forEach(meld => {\n      usedTiles += meld.tiles.length;\n    });\n  });\n\n  // 计算弃牌数量\n  usedTiles += gameState.discarded_tiles.length;\n  return Math.max(0, totalTiles - usedTiles);\n};","map":{"version":3,"names":["TileType","MeldType","GangType","InputMode","createTile","type","value","tileToCode","tile","WAN","TIAO","TONG","ZI","Error","codeToTile","code","tileToString","typeMap","tilesEqual","tile1","tile2","calculateRemainingTiles","gameState","totalTiles","usedTiles","Object","values","player_hands","forEach","hand","tiles","length","melds","meld","discarded_tiles","Math","max"],"sources":["D:/codes/PocketFlow-Tutorial-Codebase-Knowledge/paul/mj/frontend/src/types/mahjong.ts"],"sourcesContent":["export enum TileType {\n  WAN = \"wan\",      // 万\n  TIAO = \"tiao\",    // 条\n  TONG = \"tong\",    // 筒\n  ZI = \"zi\"         // 字牌\n}\n\nexport interface Tile {\n  type: TileType;\n  value: number;\n}\n\nexport enum MeldType {\n  PENG = \"peng\",    // 碰\n  GANG = \"gang\",    // 杠\n  CHI = \"chi\"       // 吃\n}\n\nexport enum GangType {\n  MING_GANG = \"ming_gang\",  // 明杠（直杠）\n  AN_GANG = \"an_gang\",      // 暗杠\n  JIA_GANG = \"jia_gang\"     // 加杠\n}\n\nexport interface Meld {\n  type: MeldType;\n  tiles: Tile[];\n  exposed: boolean;\n  gang_type?: GangType; // 杠牌类型（仅当type为GANG时有效）\n}\n\nexport interface HandTiles {\n  tiles: Tile[];\n  melds: Meld[];\n}\n\nexport interface PlayerAction {\n  player_id: number;\n  action_type: string;\n  tiles: Tile[];\n  timestamp?: number;\n}\n\nexport interface GameState {\n  player_hands: { [key: number]: HandTiles };\n  discarded_tiles: Tile[];\n  player_discarded_tiles?: { [key: number]: Tile[] };\n  remaining_tiles: Tile[];\n  current_player: number;\n  actions_history: PlayerAction[];\n}\n\nexport interface AnalysisResult {\n  recommended_discard?: Tile;\n  discard_scores: { [key: string]: number };\n  listen_tiles: Tile[];\n  win_probability: number;\n  remaining_tiles_count: { [key: number]: number };\n  suggestions: string[];\n}\n\nexport interface GameRequest {\n  game_state: GameState;\n  target_player: number;\n}\n\nexport interface GameResponse {\n  success: boolean;\n  analysis?: AnalysisResult;\n  message: string;\n}\n\nexport interface TileInfo {\n  code: number;\n  type: string;\n  value: number;\n  display: string;\n}\n\n// 输入模式枚举\nexport enum InputMode {\n  ADD_TO_HAND = \"add_to_hand\",\n  DISCARD = \"discard\", \n  PENG = \"peng\",\n  MING_GANG = \"ming_gang\",\n  AN_GANG = \"an_gang\"\n}\n\n// 工具函数\nexport const createTile = (type: TileType, value: number): Tile => ({\n  type,\n  value\n});\n\nexport const tileToCode = (tile: Tile): number => {\n  switch (tile.type) {\n    case TileType.WAN:\n      return tile.value;\n    case TileType.TIAO:\n      return tile.value + 10;\n    case TileType.TONG:\n      return tile.value + 20;\n    case TileType.ZI:\n      return tile.value + 30;\n    default:\n      throw new Error(`Invalid tile type: ${tile.type}`);\n  }\n};\n\nexport const codeToTile = (code: number): Tile => {\n  if (1 <= code && code <= 9) {\n    return { type: TileType.WAN, value: code };\n  } else if (11 <= code && code <= 19) {\n    return { type: TileType.TIAO, value: code - 10 };\n  } else if (21 <= code && code <= 29) {\n    return { type: TileType.TONG, value: code - 20 };\n  } else if (31 <= code && code <= 37) {\n    return { type: TileType.ZI, value: code - 30 };\n  } else {\n    throw new Error(`Invalid tile code: ${code}`);\n  }\n};\n\nexport const tileToString = (tile: Tile): string => {\n  const typeMap = {\n    [TileType.WAN]: \"万\",\n    [TileType.TIAO]: \"条\", \n    [TileType.TONG]: \"筒\",\n    [TileType.ZI]: [\"\", \"东\", \"南\", \"西\", \"北\", \"中\", \"发\", \"白\"][tile.value] || \"\"\n  };\n  \n  if (tile.type === TileType.ZI) {\n    return typeMap[tile.type];\n  } else {\n    return `${tile.value}${typeMap[tile.type]}`;\n  }\n};\n\nexport const tilesEqual = (tile1: Tile, tile2: Tile): boolean => {\n  return tile1.type === tile2.type && tile1.value === tile2.value;\n};\n\n// 计算剩余牌数\nexport const calculateRemainingTiles = (gameState: GameState): number => {\n  const totalTiles = 144; // 标准麻将总牌数\n  \n  // 计算已使用的牌数\n  let usedTiles = 0;\n  \n  // 计算所有玩家手牌数量\n  Object.values(gameState.player_hands).forEach(hand => {\n    usedTiles += hand.tiles.length;\n    // 计算碰牌杠牌数量\n    hand.melds.forEach(meld => {\n      usedTiles += meld.tiles.length;\n    });\n  });\n  \n  // 计算弃牌数量\n  usedTiles += gameState.discarded_tiles.length;\n  \n  return Math.max(0, totalTiles - usedTiles);\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}