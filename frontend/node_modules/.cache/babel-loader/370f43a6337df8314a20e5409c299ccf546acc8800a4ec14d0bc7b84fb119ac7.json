{"ast":null,"code":"import React from'react';import{motion}from'framer-motion';import classNames from'classnames';import MahjongTile from'./MahjongTile';import SourceIndicator from'./SourceIndicator';import{tileToString}from'../types/mahjong';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const KongDisplay=_ref=>{let{kong,playerPosition,className,showTooltip=true,cardBackStyle='elegant'}=_ref;const getCardLayout=()=>{if(kong.type==='direct_kong'){return getDirectKongLayout();}else if(kong.type==='added_kong'){return getAddedKongLayout();}else{return getConcealedKongLayout();}};const getDirectKongLayout=()=>{// 直杠布局：3张竖放 + 1张横放（表示来源）\nreturn/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container direct-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"vertical-cards flex\",children:kong.tiles.slice(0,3).map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-vertical-\").concat(index)))}),/*#__PURE__*/_jsxs(\"div\",{className:\"horizontal-card relative ml-2\",children:[/*#__PURE__*/_jsx(MahjongTile,{tile:kong.tiles[3],size:\"small\",className:\"transform rotate-90\",cardBackStyle:cardBackStyle}),kong.source_player!==undefined&&/*#__PURE__*/_jsx(SourceIndicator,{sourcePlayer:kong.source_player,currentPlayer:kong.kong_player,position:playerPosition})]})]});};const getAddedKongLayout=()=>{// 加杠布局：原碰牌3张正面 + 新加1张背面（有特殊标记）\nreturn/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container added-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"original-peng flex\",children:kong.tiles.slice(0,3).map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-original-\").concat(index)))}),/*#__PURE__*/_jsxs(\"div\",{className:\"added-card relative ml-2\",children:[/*#__PURE__*/_jsx(MahjongTile,{tile:kong.tiles[3],size:\"small\",variant:\"back\",className:\"border-2 border-yellow-400 shadow-lg\",cardBackStyle:cardBackStyle}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 bg-yellow-400 text-black text-xs px-1 rounded font-bold shadow-sm z-20\",children:\"\\u52A0\"})]})]});};const getConcealedKongLayout=()=>{// 暗杠布局：所有4张牌都显示背面\nreturn/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container concealed-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"concealed-cards flex\",children:kong.tiles.map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",variant:\"back\",className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-concealed-\").concat(index)))}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-2 -right-2 bg-gray-600 text-white text-xs px-1 rounded font-bold shadow-sm z-20\",children:\"\\u6697\"})]});};const getTooltipText=()=>{if(kong.type==='direct_kong'){return\"\\u76F4\\u6760 - \\u6760\\u4E86\\u73A9\\u5BB6\".concat((kong.source_player||0)+1,\"\\u7684\").concat(tileToString(kong.card));}else if(kong.type==='added_kong'){return\"\\u52A0\\u6760 - \\u5728\\u539F\\u6709\\u78B0\\u724C\\u57FA\\u7840\\u4E0A\\u52A0\\u6760\".concat(tileToString(kong.card));}else{return\"\\u6697\\u6760 - \\u6697\\u4E2D\\u6760\\u4E86\".concat(tileToString(kong.card));}};const containerClasses=classNames('kong-display-container relative p-2 bg-gray-50 rounded-lg border border-gray-200 shadow-sm','hover:shadow-md transition-shadow duration-200',{[\"player-\".concat(playerPosition)]:true});return/*#__PURE__*/_jsxs(motion.div,{className:containerClasses,initial:{scale:0.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:0.5,type:\"spring\",stiffness:120},children:[getCardLayout(),showTooltip&&/*#__PURE__*/_jsx(\"div\",{className:\"tooltip-container group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10\",children:[getTooltipText(),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-black\"})]})})]});};export default KongDisplay;","map":{"version":3,"names":["React","motion","classNames","MahjongTile","SourceIndicator","tileToString","jsx","_jsx","jsxs","_jsxs","KongDisplay","_ref","kong","playerPosition","className","showTooltip","cardBackStyle","getCardLayout","type","getDirectKongLayout","getAddedKongLayout","getConcealedKongLayout","children","tiles","slice","map","tile","index","size","seamless","direction","concat","id","source_player","undefined","sourcePlayer","currentPlayer","kong_player","position","variant","getTooltipText","card","containerClasses","div","initial","scale","opacity","animate","transition","duration","stiffness"],"sources":["D:/codes/PocketFlow-Tutorial-Codebase-Knowledge/paul/mj/frontend/src/components/KongDisplay.tsx"],"sourcesContent":["import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport classNames from 'classnames';\r\nimport MahjongTile from './MahjongTile';\r\nimport SourceIndicator from './SourceIndicator';\r\nimport { KongMeld, tileToString } from '../types/mahjong';\r\n\r\ninterface KongDisplayProps {\r\n  kong: KongMeld;\r\n  playerPosition: 'bottom' | 'right' | 'top' | 'left';\r\n  className?: string;\r\n  showTooltip?: boolean;\r\n  cardBackStyle?: 'classic' | 'elegant' | 'bamboo' | 'cloud' | 'traditional' | 'pure';\r\n}\r\n\r\nconst KongDisplay: React.FC<KongDisplayProps> = ({ \r\n  kong, \r\n  playerPosition, \r\n  className,\r\n  showTooltip = true,\r\n  cardBackStyle = 'elegant'\r\n}) => {\r\n  const getCardLayout = () => {\r\n    if (kong.type === 'direct_kong') {\r\n      return getDirectKongLayout();\r\n    } else if (kong.type === 'added_kong') {\r\n      return getAddedKongLayout();\r\n    } else {\r\n      return getConcealedKongLayout();\r\n    }\r\n  };\r\n\r\n  const getDirectKongLayout = () => {\r\n    // 直杠布局：3张竖放 + 1张横放（表示来源）\r\n    return (\r\n      <div className={classNames('kong-container direct-kong flex items-end', className)}>\r\n        {/* 前3张牌竖放 */}\r\n        <div className=\"vertical-cards flex\">\r\n          {kong.tiles.slice(0, 3).map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-vertical-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 第4张牌横放，表示来自其他玩家 */}\r\n        <div className=\"horizontal-card relative ml-2\">\r\n          <MahjongTile\r\n            tile={kong.tiles[3]}\r\n            size=\"small\"\r\n            className=\"transform rotate-90\"\r\n            cardBackStyle={cardBackStyle}\r\n          />\r\n          \r\n          {/* 来源指示器 */}\r\n          {kong.source_player !== undefined && (\r\n            <SourceIndicator \r\n              sourcePlayer={kong.source_player}\r\n              currentPlayer={kong.kong_player}\r\n              position={playerPosition}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getAddedKongLayout = () => {\r\n    // 加杠布局：原碰牌3张正面 + 新加1张背面（有特殊标记）\r\n    return (\r\n      <div className={classNames('kong-container added-kong flex items-end', className)}>\r\n        {/* 原来的3张碰牌 - 正面显示 */}\r\n        <div className=\"original-peng flex\">\r\n          {kong.tiles.slice(0, 3).map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-original-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 新加的第4张牌 - 背面显示 */}\r\n        <div className=\"added-card relative ml-2\">\r\n          <MahjongTile\r\n            tile={kong.tiles[3]}\r\n            size=\"small\"\r\n            variant=\"back\"\r\n            className=\"border-2 border-yellow-400 shadow-lg\"\r\n            cardBackStyle={cardBackStyle}\r\n          />\r\n          \r\n          {/* 加杠标识 */}\r\n          <div className=\"absolute -top-1 -right-1 bg-yellow-400 text-black text-xs px-1 rounded font-bold shadow-sm z-20\">\r\n            加\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getConcealedKongLayout = () => {\r\n    // 暗杠布局：所有4张牌都显示背面\r\n    return (\r\n      <div className={classNames('kong-container concealed-kong flex items-end', className)}>\r\n        {/* 所有4张牌都显示背面 */}\r\n        <div className=\"concealed-cards flex\">\r\n          {kong.tiles.map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-concealed-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              variant=\"back\"\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 暗杠标识 */}\r\n        <div className=\"absolute -top-2 -right-2 bg-gray-600 text-white text-xs px-1 rounded font-bold shadow-sm z-20\">\r\n          暗\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getTooltipText = () => {\r\n    if (kong.type === 'direct_kong') {\r\n      return `直杠 - 杠了玩家${(kong.source_player || 0) + 1}的${tileToString(kong.card)}`;\r\n    } else if (kong.type === 'added_kong') {\r\n      return `加杠 - 在原有碰牌基础上加杠${tileToString(kong.card)}`;\r\n    } else {\r\n      return `暗杠 - 暗中杠了${tileToString(kong.card)}`;\r\n    }\r\n  };\r\n\r\n  const containerClasses = classNames(\r\n    'kong-display-container relative p-2 bg-gray-50 rounded-lg border border-gray-200 shadow-sm',\r\n    'hover:shadow-md transition-shadow duration-200',\r\n    {\r\n      [`player-${playerPosition}`]: true,\r\n    }\r\n  );\r\n\r\n  return (\r\n    <motion.div\r\n      className={containerClasses}\r\n      initial={{ scale: 0.8, opacity: 0 }}\r\n      animate={{ scale: 1, opacity: 1 }}\r\n      transition={{ duration: 0.5, type: \"spring\", stiffness: 120 }}\r\n    >\r\n      {getCardLayout()}\r\n      \r\n      {/* 悬停提示 */}\r\n      {showTooltip && (\r\n        <div className=\"tooltip-container group\">\r\n          <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10\">\r\n            {getTooltipText()}\r\n            {/* 小箭头 */}\r\n            <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-black\"></div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default KongDisplay; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}