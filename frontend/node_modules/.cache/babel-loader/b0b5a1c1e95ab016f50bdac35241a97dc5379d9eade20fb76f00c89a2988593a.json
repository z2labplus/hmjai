{"ast":null,"code":"import React from'react';import{motion}from'framer-motion';import classNames from'classnames';import MahjongTile from'./MahjongTile';import SourceIndicator from'./SourceIndicator';import{tileToString}from'../types/mahjong';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const KongDisplay=_ref=>{let{kong,playerPosition,className,showTooltip=true,cardBackStyle='elegant',isCurrentPlayer=false}=_ref;const getCardLayout=()=>{if(kong.type==='direct_kong'){return getDirectKongLayout();}else if(kong.type==='added_kong'){return getAddedKongLayout();}else{return getConcealedKongLayout();}};const getDirectKongLayout=()=>{// 直杠布局：3张竖放 + 1张横放（表示来源）\nreturn/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container direct-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"vertical-cards flex\",children:kong.tiles.slice(0,3).map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-vertical-\").concat(index)))}),/*#__PURE__*/_jsxs(\"div\",{className:\"horizontal-card relative ml-2\",children:[/*#__PURE__*/_jsx(MahjongTile,{tile:kong.tiles[3],size:\"small\",className:\"transform rotate-90\",cardBackStyle:cardBackStyle}),kong.source_player!==undefined&&/*#__PURE__*/_jsx(SourceIndicator,{sourcePlayer:kong.source_player,currentPlayer:kong.kong_player,position:playerPosition})]})]});};const getAddedKongLayout=()=>{// 加杠布局：原碰牌3张正面 + 新加1张背面（有特殊标记）\nreturn/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container added-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"original-peng flex\",children:kong.tiles.slice(0,3).map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-original-\").concat(index)))}),/*#__PURE__*/_jsxs(\"div\",{className:\"added-card relative ml-2\",children:[/*#__PURE__*/_jsx(MahjongTile,{tile:kong.tiles[3],size:\"small\",variant:\"back\",className:\"border-2 border-yellow-400 shadow-lg\",cardBackStyle:cardBackStyle}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 bg-yellow-400 text-black text-xs px-1 rounded font-bold shadow-sm z-20\",children:\"\\u52A0\"})]})]});};const getConcealedKongLayout=()=>{// 暗杠布局：当前玩家显示selected样式，其他玩家显示背面\nconst tileVariant=isCurrentPlayer?'selected':'back';return/*#__PURE__*/_jsxs(\"div\",{className:classNames('kong-container concealed-kong flex items-end',className),children:[/*#__PURE__*/_jsx(\"div\",{className:\"concealed-cards flex\",children:kong.tiles.map((tile,index)=>/*#__PURE__*/_jsx(MahjongTile,{tile:tile,size:\"small\",variant:tileVariant,className:\"mr-1\",seamless:true,direction:\"horizontal\",cardBackStyle:cardBackStyle},\"\".concat(kong.id,\"-concealed-\").concat(index)))}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-2 -right-2 bg-gray-600 text-white text-xs px-1 rounded font-bold shadow-sm z-20\",children:\"\\u6697\"})]});};const getTooltipText=()=>{if(kong.type==='direct_kong'){return\"\\u76F4\\u6760 - \\u6760\\u4E86\\u73A9\\u5BB6\".concat((kong.source_player||0)+1,\"\\u7684\").concat(tileToString(kong.card));}else if(kong.type==='added_kong'){return\"\\u52A0\\u6760 - \\u5728\\u539F\\u6709\\u78B0\\u724C\\u57FA\\u7840\\u4E0A\\u52A0\\u6760\".concat(tileToString(kong.card));}else{return\"\\u6697\\u6760 - \\u6697\\u4E2D\\u6760\\u4E86\".concat(tileToString(kong.card));}};const containerClasses=classNames('kong-display-container relative p-2 bg-gray-50 rounded-lg border border-gray-200 shadow-sm','hover:shadow-md transition-shadow duration-200',{[\"player-\".concat(playerPosition)]:true});return/*#__PURE__*/_jsxs(motion.div,{className:containerClasses,initial:{scale:0.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:0.5,type:\"spring\",stiffness:120},children:[getCardLayout(),showTooltip&&/*#__PURE__*/_jsx(\"div\",{className:\"tooltip-container group\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10\",children:[getTooltipText(),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-black\"})]})})]});};export default KongDisplay;","map":{"version":3,"names":["React","motion","classNames","MahjongTile","SourceIndicator","tileToString","jsx","_jsx","jsxs","_jsxs","KongDisplay","_ref","kong","playerPosition","className","showTooltip","cardBackStyle","isCurrentPlayer","getCardLayout","type","getDirectKongLayout","getAddedKongLayout","getConcealedKongLayout","children","tiles","slice","map","tile","index","size","seamless","direction","concat","id","source_player","undefined","sourcePlayer","currentPlayer","kong_player","position","variant","tileVariant","getTooltipText","card","containerClasses","div","initial","scale","opacity","animate","transition","duration","stiffness"],"sources":["D:/codes/PocketFlow-Tutorial-Codebase-Knowledge/paul/mj/frontend/src/components/KongDisplay.tsx"],"sourcesContent":["import React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport classNames from 'classnames';\r\nimport MahjongTile from './MahjongTile';\r\nimport SourceIndicator from './SourceIndicator';\r\nimport { KongMeld, tileToString } from '../types/mahjong';\r\n\r\ninterface KongDisplayProps {\r\n  kong: KongMeld;\r\n  playerPosition: 'bottom' | 'right' | 'top' | 'left';\r\n  className?: string;\r\n  showTooltip?: boolean;\r\n  cardBackStyle?: 'classic' | 'elegant' | 'bamboo' | 'cloud' | 'traditional' | 'pure';\r\n  isCurrentPlayer?: boolean;\r\n}\r\n\r\nconst KongDisplay: React.FC<KongDisplayProps> = ({ \r\n  kong, \r\n  playerPosition, \r\n  className,\r\n  showTooltip = true,\r\n  cardBackStyle = 'elegant',\r\n  isCurrentPlayer = false\r\n}) => {\r\n  const getCardLayout = () => {\r\n    if (kong.type === 'direct_kong') {\r\n      return getDirectKongLayout();\r\n    } else if (kong.type === 'added_kong') {\r\n      return getAddedKongLayout();\r\n    } else {\r\n      return getConcealedKongLayout();\r\n    }\r\n  };\r\n\r\n  const getDirectKongLayout = () => {\r\n    // 直杠布局：3张竖放 + 1张横放（表示来源）\r\n    return (\r\n      <div className={classNames('kong-container direct-kong flex items-end', className)}>\r\n        {/* 前3张牌竖放 */}\r\n        <div className=\"vertical-cards flex\">\r\n          {kong.tiles.slice(0, 3).map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-vertical-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 第4张牌横放，表示来自其他玩家 */}\r\n        <div className=\"horizontal-card relative ml-2\">\r\n          <MahjongTile\r\n            tile={kong.tiles[3]}\r\n            size=\"small\"\r\n            className=\"transform rotate-90\"\r\n            cardBackStyle={cardBackStyle}\r\n          />\r\n          \r\n          {/* 来源指示器 */}\r\n          {kong.source_player !== undefined && (\r\n            <SourceIndicator \r\n              sourcePlayer={kong.source_player}\r\n              currentPlayer={kong.kong_player}\r\n              position={playerPosition}\r\n            />\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getAddedKongLayout = () => {\r\n    // 加杠布局：原碰牌3张正面 + 新加1张背面（有特殊标记）\r\n    return (\r\n      <div className={classNames('kong-container added-kong flex items-end', className)}>\r\n        {/* 原来的3张碰牌 - 正面显示 */}\r\n        <div className=\"original-peng flex\">\r\n          {kong.tiles.slice(0, 3).map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-original-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 新加的第4张牌 - 背面显示 */}\r\n        <div className=\"added-card relative ml-2\">\r\n          <MahjongTile\r\n            tile={kong.tiles[3]}\r\n            size=\"small\"\r\n            variant=\"back\"\r\n            className=\"border-2 border-yellow-400 shadow-lg\"\r\n            cardBackStyle={cardBackStyle}\r\n          />\r\n          \r\n          {/* 加杠标识 */}\r\n          <div className=\"absolute -top-1 -right-1 bg-yellow-400 text-black text-xs px-1 rounded font-bold shadow-sm z-20\">\r\n            加\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getConcealedKongLayout = () => {\r\n    // 暗杠布局：当前玩家显示selected样式，其他玩家显示背面\r\n    const tileVariant = isCurrentPlayer ? 'selected' : 'back';\r\n    \r\n    return (\r\n      <div className={classNames('kong-container concealed-kong flex items-end', className)}>\r\n        {/* 根据是否是当前玩家决定显示方式 */}\r\n        <div className=\"concealed-cards flex\">\r\n          {kong.tiles.map((tile, index) => (\r\n            <MahjongTile\r\n              key={`${kong.id}-concealed-${index}`}\r\n              tile={tile}\r\n              size=\"small\"\r\n              variant={tileVariant}\r\n              className=\"mr-1\"\r\n              seamless={true}\r\n              direction=\"horizontal\"\r\n              cardBackStyle={cardBackStyle}\r\n            />\r\n          ))}\r\n        </div>\r\n        \r\n        {/* 暗杠标识 */}\r\n        <div className=\"absolute -top-2 -right-2 bg-gray-600 text-white text-xs px-1 rounded font-bold shadow-sm z-20\">\r\n          暗\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getTooltipText = () => {\r\n    if (kong.type === 'direct_kong') {\r\n      return `直杠 - 杠了玩家${(kong.source_player || 0) + 1}的${tileToString(kong.card)}`;\r\n    } else if (kong.type === 'added_kong') {\r\n      return `加杠 - 在原有碰牌基础上加杠${tileToString(kong.card)}`;\r\n    } else {\r\n      return `暗杠 - 暗中杠了${tileToString(kong.card)}`;\r\n    }\r\n  };\r\n\r\n  const containerClasses = classNames(\r\n    'kong-display-container relative p-2 bg-gray-50 rounded-lg border border-gray-200 shadow-sm',\r\n    'hover:shadow-md transition-shadow duration-200',\r\n    {\r\n      [`player-${playerPosition}`]: true,\r\n    }\r\n  );\r\n\r\n  return (\r\n    <motion.div\r\n      className={containerClasses}\r\n      initial={{ scale: 0.8, opacity: 0 }}\r\n      animate={{ scale: 1, opacity: 1 }}\r\n      transition={{ duration: 0.5, type: \"spring\", stiffness: 120 }}\r\n    >\r\n      {getCardLayout()}\r\n      \r\n      {/* 悬停提示 */}\r\n      {showTooltip && (\r\n        <div className=\"tooltip-container group\">\r\n          <div className=\"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-black text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10\">\r\n            {getTooltipText()}\r\n            {/* 小箭头 */}\r\n            <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-2 border-r-2 border-t-2 border-transparent border-t-black\"></div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default KongDisplay; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}